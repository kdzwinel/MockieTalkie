/**
 * AngularJS model
 * @version v0.0.1 - 2014-03-10
 * @link 
 * @author Kenneth Lynne <kenneth.lynne@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */angular.module("ngSymbiosis.model",[]).factory("BaseModel",["$q","$http","$rootScope",function(a,b,c){function d(a,b){var d=this;if(!a.url)throw new Error("You must specify an url");this.$settings={urlBase:a.url},delete a.url,this.$settings.tracker=b&&b.tracker?b.tracker:Math.random().toString(36).substring(2),this.$set(a),c.$watch(function(){var a=angular.copy(d);for(var b in a)"$"===b.substr(0,1)&&delete a[b];return a},function(a,b){a!==b&&(d.$isDirty=!0,d.$_changeSubscribers.forEach(function(a){a()}))},!0)}return d.prototype={$set:function(a,b){var c=this;b&&(c.$isDirty=!1);for(var d in c)"$"!==d.substr(0,1)&&delete c[d];angular.extend(c,a)},$delete:function(){var a=this;a.$isDeleting=!0;var c=b.delete(a.$settings.urlBase+"/"+a.id,a,{tracker:a.$settings.tracker+"-"+a.id+"-delete"}).then(function(b){return a.$set(b.data,!0),b});return c.finally(function(){a.$isDeleting=!1}),c},$save:function(){function a(a){return c.$set(a.data,!0),a}var c=this;c.$isSaving=!0;var d;return d=c.id?b.put(c.$settings.urlBase+"/"+c.id,c,{tracker:c.$settings.tracker+"-"+c.id+"-patch"}).then(a):b.post(c.$settings.urlBase,c,{tracker:c.$settings.tracker+"-$new$-post"}).then(a),d.finally(function(){c.$isSaving=!1}),d},$_changeSubscribers:[],$isDirty:!1,$onChange:function(a){var b=this;b.$_changeSubscribers.push(a)},$isDeleting:!1,$isSaving:!1},d}]);