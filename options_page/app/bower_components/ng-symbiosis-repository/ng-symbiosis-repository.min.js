/**
 * AngularJS repository
 * @version v0.0.1 - 2014-02-23
 * @link 
 * @author Kenneth Lynne <kenneth.lynne@gmail.com
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */angular.module("ngSymbiosis.repository",[]).factory("BaseRepository",["$q","$http",function(a,b){function c(a){if(!a.name)throw new Error("You must specify a name");this.$settings={name:a.name,model:a.model},this.cache=[]}return c.prototype.getById=function(c){var d=this,e=d.$settings.model,f=a.defer(),g=d.cache[c];return g?(f.resolve(g),f.promise):b.get(e.$settings.url+"/"+c,{tracker:d.$settings.name+".getById"}).then(function(a){var b=new e(a.data);return d.cache[c]=b,b})},c.prototype.getAll=function(){var a=this,c=a.$settings.model;return b.get(c.$settings.url,{tracker:a.$settings.name+".getAll"}).then(function(b){if(angular.isArray(b.data))return a.cache.length=0,b.data.map(function(b){var d=new c(b);return a.cache[b.id]=d,d});throw new Error("Unexpected response from API. Expected Array, got "+typeof b.data,b.data)})},c.prototype.attach=function(a){var b=this,c=b.$settings.model;if(!(a instanceof c))throw new Error("You must provide a valid "+b.$settings.name+"Model");b.cache[a.id]=a},c.prototype.create=function(a){var b=this,c=b.$settings.model;return new c(a)},c}]);